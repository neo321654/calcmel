# Automatically generated on 2021-11-14 UTC from https://codemagic.io/app/6191537e4226b2d228a927e1/settings
# Note that this configuration is not an exact match to UI settings. Review and adjust as necessary.

workflows:
  default-workflow:
    name: Default Workflow
    max_build_duration: 60
    environment:
      vars:
        APP_STORE_CONNECT_ISSUER_ID: dded258b-e67d-4977-b7c0-1035d0747872
        APP_STORE_CONNECT_KEY_IDENTIFIER: 4PJZWH45RU
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmhrV0FjeXdSTkdpRjJJXzU1Qjd5U1p1YjlUWHV1QjhGcnhUTURVeXZRUjNmcGtlVGt3SC0xQUM3QlVnV2tPUFF2SVBHOUhGc0ZiMHpOWjZxZEtYcDFkMGhPdHNRRkFFb2lxYjF1UUFCejkySVNlamVGME02ZnhKM1pmS2hna0hEMFVpRE1TME03dDNHcllrZEgzNTZYVTFZTXhGQnZPMmpEV3F2UHozYnRsRmV5NFp0c2w3Ry05VzJpd1hGLWROMDBCMUxUYURKbXdYVE1nRWNJb2xBQlM1aUNDMWFvcE5tbmRlYVhNejY3QTF1WExZRURUa1otaHN0UXNzMWYzVy13MFBRR0Z5QWhwQWgtaUgtZ3hvMm0yYnlIQ3RNRnlhakZkaWtZckdSbFVCR2lJU0JPNmkyMVVGX2lVeWp6cVlmT3FtN0JhcXVDV0MyWVlhYmxjR1BUbi0wbDE1aGk3cV9iQUVTekdVN0RZZHY5OWN2eXpmS19vd3FMWjB6UzNGN0pSVDl5YWNjRjJtMEdlVU01QVlEX3BycDQ2WmJGeG44QnJVbWxadUdNa055NkdhVT0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmhrV0FibXFXN29DTWZocEJKVlpGS2NobXROUVJwQ3h6S1FLa2lNM2pkaGVVUS1iMVk4X3lrVVIwVHZnRkQ5X1ZYcnFlWW9QeEthREFMYUhZdEREcEhCb1JhWTRpcVc2Q0NFdDhscnBtaWdYZU1tSFZ0Yl9RSlNZREtxQm9rTDJRM0d3dGN2UjMydDctel9TVW1qS3BCZ09LNE0zY2pQS3hLUVJGX25OLWFlbEp0RTNsRGh0bU5QMU12V3hNcXFKRXVKaEdCMUhVMUlXbDk2cU5fcllBckswMzBZSjVIWmxYa0VIRUlhN3hTOWkxRUZldlQ5cjlVMzdjcFNBbUlLdlJ2ZDdRZGU1aHpaaVFhTnZSWEhKWVJWcEdOMDdOWmNZM3lWTzl6RzhmS1ByVUdZUEFaTnhOc3Fsa0pUSzRIb3RvYXh2a1ptYXdZSTFjOHlST244NzJCaHJkNUpXZjlkb1hSN1VrUkpITkxuYlFwLXhVSmZZUzFQMFNCd2NFN0kzOEFWY2s2SDF4RzR6UTlMazNxd01FNXh5MGZGb2hFSm1obDZ0Q1EwTFp4MmV2Y3F4Y1p6ODN0Y3pUY3FQRGVoVEp4VE43LUo2WDFMU0Q0VXFyQVB1a0JJVGFKeFJhRTZMS1lISnRVc1BFSjZ6NTlRaEt6MjBYWVFGMG9LNUNZbElTVGlTbDRObjFlazYwMHRTNHV5QzBlb0luWTNWVG5Nbk11VENBLWVBTC1IUnh0cHY5QmRSSXVuMmlIZVNhNmNiUms3TTFHbmNhUXBqX0tOMVZ3U2JRV2V6Mi1JMTk2Q0VnU2ppdWxXYktZdUdQYmJvM1NyV1Nvbk1PYnNERFd0dkEwaVFYT0p3TzRtT2FtNmlYajFTTkdXQ3hNS2FiWFZEZnpTNVBmTGNVQjFLN09LNnpnN3FLaGVrODFyaHNldWFSSTBaRGhrdEFmcXNQMEN1UjBxb1NXYW9wLWVxZnFRRUpjSU1nQTRaUmZkd0VGRkZyMkVmX0ZPNWpzQm1lWUVSTk52MGxWNG5QdnUwMmsyYkxYT1BtaFdFZkhHNHFCYWRxYjZpOXhKZGgxVURTSkRncjU4U284OVQydVI4QnNRVlk5Y0NqbGR1VlpOS2Q1NEItdTlGSTZjZFNNS3lLY0FPTkVsOG9FWWxXOWlDX1BlWDRtTWhNUXJnLXJNU1NiTExodlpGZ1NjTk1rRHNrakFDZm9uREowM19wX09Ed2tEWlYxU3BOZmtOM2lJX090V3RhRUlpQzhzWWIxOXpaYTRDOXBjeHIxcTQ5RFpER2Fkamp2MGhDelMwYWUwRC1NVU1CYXE5VkdacG8yWEpLWkJFUFlBMWV6aFBnN0RKN3ZaREREZkVuRlViSHNqMEtTWHVjd3JlU012cHhGMWh6Y2hmSWhHcWxxRDhRLVJvakd5T0FQb3Z2MFBkTEU3VXJOc29hTlN1el91NUpZSFpuWU5LZGhrc0hpVnAyQW5tTTVudmZuQU9IRDE4enZyWUlDdGc3M1dpUkhULWZnZWxHcm4zWWxDUHVuTHlNT2VkRmpWTTNTS1FpQW4tajNfTElDWGxHcU5ZeklzN05XZnVoaG01dUlPUlk3M1pYMzFERGdCVzRJVGtFQVp1d2JzOUJvTXNEQndMYm9ZbHRscW5xeFh4dGQ0NENGYW5nUkh0WkYyX0RrZUNIb2h2TnVtRFpXVnZfRWh0a1VDLUJYQS02SVBqTVlubWpZc045c20zUGJ5NllRcjV3T1dFSWNkMkRDdDZsOVRRUjNmWDdWNzZJcXdzQ1JZdkV1dkxhMUVzdGhSSTB4WXR6RlFRdzdPUTUyYmlsSkNiTWNWR2xCSll6REUxdHdXZk1HLTl6aFdJbm5Cekt1QzZvYU9kMWxjOFhzbmxOalhITC1jQXdpbndRVEJpcG5ZbWF5UEdiZFZYWjZKNnVVcERva0lxUG5qTGNCYndESTNncDhLUGtrQWFkaDJVYU1OZ1k0VjEzMGpkbGNjQWw4Q200amp5UTNaWm15cDFGOXhTaEt0MEVodmRZYnpRWEdyU1ktS2ZXcjhRbS1rVEs3SXVoLWFQNTdPQVczblhfak5WMVEtcC1ZM09tWnYteGtKQkhVNm5pclMya2xpUGp5X0xtME5vcEdVWkc0R1V6QXNhemJudHNZUUt4Q0dDM1p0aUU0MGd1aEhIOEtiVXExTzBXRmVLWXNfbktKSGx4clpvMk1YZm1wOG9YMFowS3o3M1RGUGY1UnV1dEhMRkxOblI4RzFlXy1UX3BsRTFXd1dyZ1BmaU51eG1mUnphVlNnYkR2WDRzYVJyQmhLelk3S3dRVjgtZkJlVzl0WnFVSE0tck1LOEJOTTJMbXprWk05LXBYdFpwMzhsR0EzZ2NoR1pJakJlOXR5VDlLSWpSbzlUSGtYai1aNXFyMDJZN3hjeHIzQlExVkFlVkNCZWg5bHJXSnU0QUZrZUFkUThpMkdmUFJCZ2toOHVFWXJIMjBOY09tOFFOMENZUG95N2ltc2pJT0h0Z1pnaTc5RlZ0V25oY0dIUk54YkVHY2JDcEUyS2k2dHo1MGlXY3E3anVDaHFmU1V2QlVvUWtsN1poUDl3cmlJeWl0elJ2QXQxMHVoMWk0a3BEM0JQSEhJdGoyUllBT01TYjlHaWVzVjJZX1hCZTY1VXhYOGVWOWw5VUhPZ3FXaGNMUVY5eWFRTmdBYzZvVWZNWHR6YnJnYUp4bWprYzVhOE1UNXo2SGx4ZXh3NGUxWEtGeTJrLXhYS1ZqZjBMSGpCd29PVFJyaENOTndMVEIxdXItZG1wMnRFbzRDVW4xVFNfUGVTMDRwMG52cElCak85RkJESjJhc1ZReGJQVnRCZjhIdk8tcXhIY2dKUGFmcTBpOENHUENEYm91QTNBMG9YRk5mTU51dFQ5Wlk5SjBHM1BFalVnSEFOcDBBVU1wcmN3dlBTMkZqM1RqLUgtbU90eXVFMnNDLXFrNzVqZnAtcVN4a0ZoYUVxVGpYNE5WTldEZnFvd1VleUFDVnBFeTl5ckk2Y0FhanNhdVB5S29RTzNFUkE2OVBTMlVrVWlU)
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - flutter packages pub get
      - find . -name "Podfile" -execdir pod install \;
      - keychain initialize
      - app-store-connect fetch-signing-files "com.example.testsert" --type IOS_APP_DEVELOPMENT
        --create
      - keychain add-certificates
      - xcode-project use-profiles
      - flutter build ipa --export-options-plist=/Users/builder/export_options.plist
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - flutter_drive.log
    publishing:
      email:
        recipients:
          - neo321654@rambler.ru

  ios-workflow:
    name: iOS Workflow
    # instance_type: mac_mini
    max_build_duration: 120
    environment:


      vars:
        APP_STORE_CONNECT_ISSUER_ID: dded258b-e67d-4977-b7c0-1035d0747872
        APP_STORE_CONNECT_KEY_IDENTIFIER: TJT8CZ5YR2
        APP_STORE_CONNECT_PRIVATE_KEY:  Encrypted(Z0FBQUFBQmhtZU1RSEdFWTgwWFRoS2gxMjgxLTlPTU90X2JueHhlMVdKbEkxRDZhMjczOUVvME5qWUlWSVpOV2VfMk5YU1pBWGU4MjRJT3R6dVVCY2ZLQzczWmVKMVJiWXllNnNXdk1qTmdqWXZrMldleGM0Z1VtYWRrNV9yNk1pdl9fOVVibExsRnlxbXpkWGhNMkE4ak1TZWhvLWczNG1yemdhb0tuNjRWT3QzM19HV1FPUTZjYm0tUmtFLVlKX2xGU09LNFM2ejE3aXlBYmtOTFpwVEVJUTQ3amxEdFI4Z1ZSNlV6Ni1yd3pKTkZyZWF2X3dDU2M5WC1oUE9PVmhacGJVczAxY05hbG5MNHdpMEZtV1BpbU1WbTdkUlFWVEpoSU0zUHpkWjIyLTFCMkIzQUdpZGJWcWNlQjZQOTRsN0NrTzEzN3V4ZkFfckc4RDNSV0FVWGJzRzJ4bHNZTVJQRTR4RlhuWm04cXZ5eGpHNGJPbjduVFM0LVA5VU5zaEp2alRDY0xlVmF5aTUxMUFGdVFRcTBPY3ZCYXVwVGZvQnAzUXVZcm5TcEhKVHR0d0FwTnA2az0=)
        CERTIFICATE_PRIVATE_KEY:  Encrypted(Z0FBQUFBQmhtZU1RUGtocXFFQXhzYnl2cWwyaTAyTFV5eUY5T2xLcVBOZDhuZzRhMXZPUHdVa3ZIdFF2R2tDLWVlZ21XbnpOQkxqR0NwT0JNV0Q0XzktV2tBSXp3dlplMzh2ckZwSlF0ZlpqaTl1WF9xVmpoTWRWYmRoOGdnQm9FTDBVR0lNOWM1ekN1Znpjb1JCcFdwWHFRMEtDdHN0UFU1YlNkTGFIR2tNelJ4MDNjX0xLM3Yta1hjc2tkNEtXY0cwdTBnQTUzRzdIVG9LaEZBeHd0a2FKSmVDdjVSTGRnell4SnpFTGNoeGc3ZHBQSTdvdHMzSl9FTXJ2TG0yYkthV1luZGIwUFFHMERubkwwOXF4Y25Ya3FRNXIyZUJscGxxLUNzYzhzR0FtODUwazRhOTBNd25NdXh6T3JRRE1DMFdpSk9mQ0NwcW15MW5NRTk2aGYtOU8zUHlhU0EzOVlBYjdSdWJrWnpFejVZTFVSS2JIYzdqNW9qSko0QmFfRkZQU2JaWmFjRDFqTmFtbjJDRTBCZ1NBdXo3dUlhVGMyUS1SNVQ4RDdZM0paWWtLVlh2cXI5UzF5aGd4X2I4R3BHZXI5VlpaMEhTMzdQZGdweW9XamhUN2EweWNmbm5QbENBdHVpLVByZWpXRlUwdWItRWVkeng4LW9qVWhzMHJHeVlHQ1EydS12QWNCbEVRNk5jZ2N4NWx5TmNXWk9tdTV4REFLdFlaLXFPeVEzdjE1QWpwcWFJTGxVa3NyN1luTVpwaDdzNkZsUC1CaDJkb2luQ2QxZzVEV3dIMXRPdXRUSDRCMXJnbklpQTMwTmtmNVRYQkJyT3lwWE1BQjdnVTcyTTkwMko2UEVJRF9SWlY1Q203dkYyTDhlRXBpajJtbVZxUmt3OXZpTFRqdnhrNmNUbF8tUWV2WUYteGhiNDQxYUlFVUNEUVF0MWl0SERvNXFueFNYWTBEYk0tcTE1Y1FCSkxtZ1ZKU19OcDFScmx6eE1mMktRdHJEeVEycGI2ejlMTWF4RDhCY2kwMjI4V1Y5VjdqazJtTXY3UVpnT1dMaEFWUmtDRzBNZVRKWFFOZVlKTzRlbmlhWG1aU3c2V243aHhWRHNseHNPWjlveFRYZ0F5UFF3SG9mcGVBVWoyNTBVUUVaSkE0U0JWNWhYUU5PWnJQVnZMN3pFYk9mcWZfZm51X05zZUJIU09SQjhiX3JzSWJOQWZDQWlqV0RRVVR5MUd3VXVCM25oZXBsR3pBUEtXZlUtQ2dMZnlJMDIzZHNUV3IzaFVTRW9hZ3NNTFE5UXpabC1lWnYxN3R1RHRHQTBCNDAzcFhFMjhjLVRzN3ZYVDE5a212WUExZjR6ZFJmZ182eUZxZ1M2Y1YwT3g4MW5Nd3VyWEx2SkxLRGsyMFdha3Z0bDZrYXczQlZOdVBVT3Q0SnFURThQUU1OczR6ZVJOMnhXM2dUb0pQazFtWkhoQlZxQ0NtanFtbXlfanhMZVNlUFF2OGhNdzlyWXB5aTk0VFFyaU44ZlQ0ZTZLSlJzN2JfaGZJSVJtdGxHZkhqSGpMbjkyZUZHYkd1bl9FV2FodnQzUTlNbHBUVTZlWUpXTlQ1QUJVbWx5Z2hDaGRLanJ1aGRJSmNrRC03YWdUb05Nc1RFYy1OX2dpUU9RTmFrVEZOY2o0NFFKaG1kZm9ESmZDSXN0eUxKQ0k4dDFDZDBnc3VYVXZCUEdSWU1Wc3VPOF9OMnAwYUxORnUtVFJ0cGhIbnJMR195VVE3ZWFZQnFoWVJ6MnprOVhYcGEzN3Y2VnhLeDJWOHdCSjgyUnhFeENmdjZ6YTVwVnJrOEhLR0RwRlktWkdqN3FVLTMtelh3OE1Qal9MNEJKR0pXMHhzMk9kckpscjQ3MmJNUU9rQWgwU0ZvS3FyVXV6R1laSzdCeEI0QkNDQ2d5cV9lajZ0NmJ0UEp2MFpMQmpCcVlGSE1sTzgyZ2lDOG9YbVdfWV9FYi04bDcxeTFDQlVSRUJRTW83aFhOSHRpODJ0X2JtZjJYWE56UjZKNmI5anAzZWF1RElPOW1zbEFxQjBFeFFXdzBXS2xHU1Q2d1VueEt1ZXlDQ2FkRkNnMWRYR3I4MWt4dXc2NTNrTFBRVlIyQjlreEJuT1B1azB3dVBtMV84QnBxc1JFNzJyX3pFSmRkXzFaT2hHcGxvSElhTWozaHFMdnF6Si1wWmhJOC0tODg3Z0xDSFdlN3FpVWFRWUxOX1I3TW1JRVhmNFd3ajZuQmM5M3lfVGlBdzFzYk9uMmJ1bXJlSWhaNHQzUW9uQVJhMUU2NjBkc2h1cXF4clB1dUdKUWRnb2NoU3pSQmcybWtfMlJfZnM2eGtPSE4wUktqZXp5dUNfdU1KXzdzUkZLY2NYSE10a1EwZ3ZBaWtxLXZ6VmJPRGdlVDY0Y2FQeW1TenBfQVM4bjRnQVlYYnNucXlyN1l2dW94bXppR1h6dmpaUkpQQlpLTnhHTEpGci1sb1B3V2VHSHpkM2lVUnJKUnQ2VWJ2QWRSbUdUT0Vwdzc2UXpid2FLZFVKaVZSWS1tajhDU2trRUpQUjF2Y0lBWnZIWllHb3Z6c0JCUVpwZnNvWURnWlpvTmZxN3hQaUIxbTJZMElZOE0tQ0toTjF3M0w4ZTdJa01yQ3E5Z3pndzdvSHVZNC1fY1VfNWYtV0ZmVGFpcnA3dml2YWMwV0hGQU8xWkFxdXFCZ09VYmVBZUpwUXJTRjZyanJqTlc4SVZRdTVTVld4Tkc0ZFJYaWF1Y2hhSHQ3M1BDN3BDcllrTEhVQVNmWVhXcUFuOFlOVkdKSzFVS1o5cXg4dVFFd29uMjU5NWJNN2F0U0VqRTQ0b0tkTWp3MDM0Vi1iQ1Y1bTBzVkN5OHA5UFFiclJ6M002VmFicXNrc3BzYmFrNHRDRXJHd3lIOXN3RGdRaW5JN3J0Z0NmMkRPZm1kWENiZkViaDF1SzVoc25FZk9RS2UybkJTZ2hEQ2hpeXdfb04xTW5iSVNVb1ZUT21YWG9UNWlrVHNzMTFRdmw1emZhdnIwMGtmV2VWT05HX1hTTUprMU5kdU5yS2U0WmN6RWZh)

        XCODE_WORKSPACE: "Runner.xcworkspace"
        XCODE_SCHEME: "Runner"
        BUNDLE_ID: "com.example.melcalc" # <-- Put your bundle id here
        APP_STORE_ID: MW924APR4Z # 2NRBAKGWD8 <-- Use the TestFlight Apple id number (An automatically generated ID assigned to your app) found under General > App Information > Apple ID.
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - name: Set up keychain to be used for codesigning using Codemagic CLI 'keychain' command
        script: |
          keychain initialize
      - name: Fetch signing files
        script: |
          app-store-connect fetch-signing-files $BUNDLE_ID --type IOS_APP_STORE --create
      - name: Use system default keychain
        script: |
          keychain add-certificates
      - name: Set up code signing settings on Xcode project
        script: |
          xcode-project use-profiles
      - name: Get Flutter packages
        script: |
          cd . && flutter packages pub get
      #      - name: Flutter analyze
      #        script: |
      #          cd . && flutter analyze
      #      - name: Flutter unit tests
      #        script: |
      #          cd . && flutter test
      #        ignore_failure: true
      - name: Install pods
        script: |
          find . -name "Podfile" -execdir pod install \;
      - name: Flutter build ipa and automatic versioning
        script: |
          flutter build ipa --release \
          --build-name=1.0.0 \
          --build-number=$(($(app-store-connect get-latest-testflight-build-number "$APP_STORE_ID") + 1)) \
          --export-options-plist=/Users/builder/export_options.plist
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - flutter_drive.log
    publishing:
      # See the following link for details about email publishing - https://docs.codemagic.io/publishing-yaml/distribution/#email
      email:
        recipients:
          - user_1@example.com
          - user_2@example.com
        notify:
          success: true     # To receive a notification when a build succeeds
          failure: false    # To not receive a notification when a build fails
      slack:
        # See the following link about how to connect your Slack account - https://docs.codemagic.io/publishing-yaml/distribution/#slack
        channel: "#builds"
        notify_on_build_start: true   # To receive a notification when a build starts
        notify:
          success: true               # To receive a notification when a build succeeds
          failure: false              # To not receive a notification when a build fails
      app_store_connect:   # https://docs.codemagic.io/publishing-yaml/distribution
        api_key: $APP_STORE_CONNECT_PRIVATE_KEY         # Contents of the API key, can also reference environment variable such as $APP_STORE_CONNECT_PRIVATE_KEY
        key_id: $APP_STORE_CONNECT_KEY_IDENTIFIER       # Alphanumeric value that identifies the API key, can also reference environment variable such as $APP_STORE_CONNECT_KEY_IDENTIFIER
        issuer_id: $APP_STORE_CONNECT_ISSUER_ID         # Alphanumeric value that identifies who created the API key, can also reference environment variable such as $APP_STORE_CONNECT_ISSUER_ID
        submit_to_testflight: false                     # Optional boolean, defaults to false. Whether or not to submit the uploaded build to TestFlight beta review. Required for distributing to beta groups. Note: This action is performed during post-processing.
        # beta_groups:                                  # Specify the names of beta tester groups that will get access to the build once it has passed beta review.
        #      - group name 1
        #      - group name 2


