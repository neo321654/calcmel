# Automatically generated on 2021-11-14 UTC from https://codemagic.io/app/6191537e4226b2d228a927e1/settings
# Note that this configuration is not an exact match to UI settings. Review and adjust as necessary.

workflows:
  default-workflow:
    name: Default Workflow
    max_build_duration: 60
    environment:
      vars:
        APP_STORE_CONNECT_ISSUER_ID: dded258b-e67d-4977-b7c0-1035d0747872
        APP_STORE_CONNECT_KEY_IDENTIFIER: 4PJZWH45RU
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmhrV0FjeXdSTkdpRjJJXzU1Qjd5U1p1YjlUWHV1QjhGcnhUTURVeXZRUjNmcGtlVGt3SC0xQUM3QlVnV2tPUFF2SVBHOUhGc0ZiMHpOWjZxZEtYcDFkMGhPdHNRRkFFb2lxYjF1UUFCejkySVNlamVGME02ZnhKM1pmS2hna0hEMFVpRE1TME03dDNHcllrZEgzNTZYVTFZTXhGQnZPMmpEV3F2UHozYnRsRmV5NFp0c2w3Ry05VzJpd1hGLWROMDBCMUxUYURKbXdYVE1nRWNJb2xBQlM1aUNDMWFvcE5tbmRlYVhNejY3QTF1WExZRURUa1otaHN0UXNzMWYzVy13MFBRR0Z5QWhwQWgtaUgtZ3hvMm0yYnlIQ3RNRnlhakZkaWtZckdSbFVCR2lJU0JPNmkyMVVGX2lVeWp6cVlmT3FtN0JhcXVDV0MyWVlhYmxjR1BUbi0wbDE1aGk3cV9iQUVTekdVN0RZZHY5OWN2eXpmS19vd3FMWjB6UzNGN0pSVDl5YWNjRjJtMEdlVU01QVlEX3BycDQ2WmJGeG44QnJVbWxadUdNa055NkdhVT0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmhrV0FibXFXN29DTWZocEJKVlpGS2NobXROUVJwQ3h6S1FLa2lNM2pkaGVVUS1iMVk4X3lrVVIwVHZnRkQ5X1ZYcnFlWW9QeEthREFMYUhZdEREcEhCb1JhWTRpcVc2Q0NFdDhscnBtaWdYZU1tSFZ0Yl9RSlNZREtxQm9rTDJRM0d3dGN2UjMydDctel9TVW1qS3BCZ09LNE0zY2pQS3hLUVJGX25OLWFlbEp0RTNsRGh0bU5QMU12V3hNcXFKRXVKaEdCMUhVMUlXbDk2cU5fcllBckswMzBZSjVIWmxYa0VIRUlhN3hTOWkxRUZldlQ5cjlVMzdjcFNBbUlLdlJ2ZDdRZGU1aHpaaVFhTnZSWEhKWVJWcEdOMDdOWmNZM3lWTzl6RzhmS1ByVUdZUEFaTnhOc3Fsa0pUSzRIb3RvYXh2a1ptYXdZSTFjOHlST244NzJCaHJkNUpXZjlkb1hSN1VrUkpITkxuYlFwLXhVSmZZUzFQMFNCd2NFN0kzOEFWY2s2SDF4RzR6UTlMazNxd01FNXh5MGZGb2hFSm1obDZ0Q1EwTFp4MmV2Y3F4Y1p6ODN0Y3pUY3FQRGVoVEp4VE43LUo2WDFMU0Q0VXFyQVB1a0JJVGFKeFJhRTZMS1lISnRVc1BFSjZ6NTlRaEt6MjBYWVFGMG9LNUNZbElTVGlTbDRObjFlazYwMHRTNHV5QzBlb0luWTNWVG5Nbk11VENBLWVBTC1IUnh0cHY5QmRSSXVuMmlIZVNhNmNiUms3TTFHbmNhUXBqX0tOMVZ3U2JRV2V6Mi1JMTk2Q0VnU2ppdWxXYktZdUdQYmJvM1NyV1Nvbk1PYnNERFd0dkEwaVFYT0p3TzRtT2FtNmlYajFTTkdXQ3hNS2FiWFZEZnpTNVBmTGNVQjFLN09LNnpnN3FLaGVrODFyaHNldWFSSTBaRGhrdEFmcXNQMEN1UjBxb1NXYW9wLWVxZnFRRUpjSU1nQTRaUmZkd0VGRkZyMkVmX0ZPNWpzQm1lWUVSTk52MGxWNG5QdnUwMmsyYkxYT1BtaFdFZkhHNHFCYWRxYjZpOXhKZGgxVURTSkRncjU4U284OVQydVI4QnNRVlk5Y0NqbGR1VlpOS2Q1NEItdTlGSTZjZFNNS3lLY0FPTkVsOG9FWWxXOWlDX1BlWDRtTWhNUXJnLXJNU1NiTExodlpGZ1NjTk1rRHNrakFDZm9uREowM19wX09Ed2tEWlYxU3BOZmtOM2lJX090V3RhRUlpQzhzWWIxOXpaYTRDOXBjeHIxcTQ5RFpER2Fkamp2MGhDelMwYWUwRC1NVU1CYXE5VkdacG8yWEpLWkJFUFlBMWV6aFBnN0RKN3ZaREREZkVuRlViSHNqMEtTWHVjd3JlU012cHhGMWh6Y2hmSWhHcWxxRDhRLVJvakd5T0FQb3Z2MFBkTEU3VXJOc29hTlN1el91NUpZSFpuWU5LZGhrc0hpVnAyQW5tTTVudmZuQU9IRDE4enZyWUlDdGc3M1dpUkhULWZnZWxHcm4zWWxDUHVuTHlNT2VkRmpWTTNTS1FpQW4tajNfTElDWGxHcU5ZeklzN05XZnVoaG01dUlPUlk3M1pYMzFERGdCVzRJVGtFQVp1d2JzOUJvTXNEQndMYm9ZbHRscW5xeFh4dGQ0NENGYW5nUkh0WkYyX0RrZUNIb2h2TnVtRFpXVnZfRWh0a1VDLUJYQS02SVBqTVlubWpZc045c20zUGJ5NllRcjV3T1dFSWNkMkRDdDZsOVRRUjNmWDdWNzZJcXdzQ1JZdkV1dkxhMUVzdGhSSTB4WXR6RlFRdzdPUTUyYmlsSkNiTWNWR2xCSll6REUxdHdXZk1HLTl6aFdJbm5Cekt1QzZvYU9kMWxjOFhzbmxOalhITC1jQXdpbndRVEJpcG5ZbWF5UEdiZFZYWjZKNnVVcERva0lxUG5qTGNCYndESTNncDhLUGtrQWFkaDJVYU1OZ1k0VjEzMGpkbGNjQWw4Q200amp5UTNaWm15cDFGOXhTaEt0MEVodmRZYnpRWEdyU1ktS2ZXcjhRbS1rVEs3SXVoLWFQNTdPQVczblhfak5WMVEtcC1ZM09tWnYteGtKQkhVNm5pclMya2xpUGp5X0xtME5vcEdVWkc0R1V6QXNhemJudHNZUUt4Q0dDM1p0aUU0MGd1aEhIOEtiVXExTzBXRmVLWXNfbktKSGx4clpvMk1YZm1wOG9YMFowS3o3M1RGUGY1UnV1dEhMRkxOblI4RzFlXy1UX3BsRTFXd1dyZ1BmaU51eG1mUnphVlNnYkR2WDRzYVJyQmhLelk3S3dRVjgtZkJlVzl0WnFVSE0tck1LOEJOTTJMbXprWk05LXBYdFpwMzhsR0EzZ2NoR1pJakJlOXR5VDlLSWpSbzlUSGtYai1aNXFyMDJZN3hjeHIzQlExVkFlVkNCZWg5bHJXSnU0QUZrZUFkUThpMkdmUFJCZ2toOHVFWXJIMjBOY09tOFFOMENZUG95N2ltc2pJT0h0Z1pnaTc5RlZ0V25oY0dIUk54YkVHY2JDcEUyS2k2dHo1MGlXY3E3anVDaHFmU1V2QlVvUWtsN1poUDl3cmlJeWl0elJ2QXQxMHVoMWk0a3BEM0JQSEhJdGoyUllBT01TYjlHaWVzVjJZX1hCZTY1VXhYOGVWOWw5VUhPZ3FXaGNMUVY5eWFRTmdBYzZvVWZNWHR6YnJnYUp4bWprYzVhOE1UNXo2SGx4ZXh3NGUxWEtGeTJrLXhYS1ZqZjBMSGpCd29PVFJyaENOTndMVEIxdXItZG1wMnRFbzRDVW4xVFNfUGVTMDRwMG52cElCak85RkJESjJhc1ZReGJQVnRCZjhIdk8tcXhIY2dKUGFmcTBpOENHUENEYm91QTNBMG9YRk5mTU51dFQ5Wlk5SjBHM1BFalVnSEFOcDBBVU1wcmN3dlBTMkZqM1RqLUgtbU90eXVFMnNDLXFrNzVqZnAtcVN4a0ZoYUVxVGpYNE5WTldEZnFvd1VleUFDVnBFeTl5ckk2Y0FhanNhdVB5S29RTzNFUkE2OVBTMlVrVWlU)
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - flutter packages pub get
      - find . -name "Podfile" -execdir pod install \;
      - keychain initialize
      - app-store-connect fetch-signing-files "com.example.testsert" --type IOS_APP_DEVELOPMENT
        --create
      - keychain add-certificates
      - xcode-project use-profiles
      - flutter build ipa --export-options-plist=/Users/builder/export_options.plist
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - flutter_drive.log
    publishing:
      email:
        recipients:
          - neo321654@rambler.ru

  ios-workflow:
    name: iOS Workflow
    # instance_type: mac_mini
    max_build_duration: 120
    environment:


      vars:
        APP_STORE_CONNECT_ISSUER_ID: dded258b-e67d-4977-b7c0-1035d0747872
        APP_STORE_CONNECT_KEY_IDENTIFIER: MW924APR4Z
        APP_STORE_CONNECT_PRIVATE_KEY:  Encrypted(Z0FBQUFBQmhtV3psdnl0MVRmdEJDMVNPczBrZG5aYjBzRGJLYU9UdlNHTXVlV3pFUXZ2NG1fRWFJOE5rdVJ0OXBBd0c2U3ViZFJCLWJEdXpYUnljalJvMjE5bHFWN0xKclVpUHRpLU9ScmpiWmxRanpTOU5XS19EUTRQOHZJZldvUTRkaDhWR1dHT1JpMEs3MmFoTllJcXJyNnRUTlRnVHB1aUg0OFZaUWpfOGpwWU9Jc3o2ellmb3p2M2pOWU92SF9GTEViWC00Z3NNSVNYbGF4Q3dBUWxhZVdfRHdITnhVRFRWaTJZQ1IyTkVfLU9xTDYyZlE4S0ZPckxGM2oxN21Za0g0OWhQcGFrZkR4QlAxM2ZlVkJ0YkNOaGsxcFJtMUtFblUydTZaNk9qSWc1MnZkNmY5eXozNDNSbEozSS1zdzl4cG1OYUFibWJZUWwwckRlM3RWTHpsOUpXN1MyNC0zblpVX0NiOXA4clA3SUYtcFhyUnpwWlBNQWZwb0hIak1YbXlJZnZfT0RVTVdRVzhERk1uaU5RN2VUVzljeEIzZlppZUJoaEplQXQ1YmxOeHVmNmxtdz0=)
        CERTIFICATE_PRIVATE_KEY:  Encrypted(Z0FBQUFBQmhtV3pscHdoZVAzWjRBZnVVaGZhQnUwMFZoOXBTZ3pDLXg0MG1nckhSRV9OLWxVZVlfejl6dk5ILVU2Zk1kSy1DaGJBdkxvdU8xdmtra3Jxa3BoVk5XaEZoVmJCSmg2VmZoRGk5eEt3YzhadVlfV3FIQVB3NU9iX2NmSWtBT25uZFpDdW4wM3k2UnhTa1JLeGYydl9vYzJzR3hYOXlLRXdqRVlYbmEwN3ZYVWNvUjRYcWFNVFNRRDMxYTZzQ3hJM3FkVnIyS182MjRyWTZxLUk2Q0RZcVBOZXB1d1QwaW1iNHdOM2JsdWc4M3Z6NWM5enRRdktGZzctdEY2ZUtXbnFIbXU4V0JVU1ZEY0Q3WkQzRHdIa3pxVkYySmpwTHlNVWlGalJqYXlLZkprWThZb1BOa2loVzcxb0s0T1oyLTlETFBUOFFZY01UZDZFbG9YUHV1c2pJU3FnZmxKYThtdnZGeWVOX3FselVxT2RFYnJkMXI3enVjelZKRUg5SUdjUnkydlpjeC1DMi1vRlNpMExUaFZmWGZoYlRNZUhPaHgxMDFLbmdKOUljd2J1Y25UZk03ZWdfWHdQY3pFSHUzd0d3anJxSUFFNEg5ZmJhbzlDRGd4R25Bcm5ZZVdPRC1iUHlsRmJTc2loQ2x2bzIwLTlqZzVqX3ByZWdtQlgxNjMtWXFCdmpyU3BKLURTUlBLVmUzbFJ4TVFDNEh5NER4OEt1bXJDRVNYSTNqVWJqaFl0ZzhoY3FrUGxlOTdGZE5lT0hjeGVLR1JxdEwtTndoSDExV0dXX2dObHpWekJOWGdjRkx3eUpSUlh4VjRodmYyTmk1cDhORjNsZDdoVWVfQlh5eGtYWldzcGVWRWd0U3lwOERoNVpTcUlDNkdqM2dGNFBqNF9IZ21sczhFdmlla3F3LXJ0M1N1ZTFaRkFraVNKQzA5cUpUeEtKTjlkWDl2Uy1WLTFITlV4VUtMWjRVanNKVFQ3MkpkUUNTTXFwZ0NHT2U5dWJvVEU1REFQMzFXeDJDNURRWGhDZzRnclQwZnpyZ2JWcHdRR0lzbFg0ekQ3RXZ4XzFfNzREZ200UG1CY2dnQmdLRjNFSG04NS13a3pERngySldiYVhTV1UyWUtmREkwdHFlcnZrZGJIaVhlSWpxMVVERDVHVTVBTTZWV2dRaTk3YUtPZ01oVmw5ZjhqdFFuYlR5ZmlHeUpQQVNyS01TY1ZvRXdPSE10UVpPQlhZdmFzSTJvanVYVXp3QWFzT1dqQkRNR3JBODUzTkZ1OHBaLUY1Y2RJQTh5dUNkS0NnSHlxUEVFM3BuZVh4RjdoREdCQ3RNMzYya2czVkF1RjNMbE4zVENOanIzQnhJa3VQaDRrZUtQNmtwOXk0Qk03X0U1aXlCV05HOXRJdGpEQWVrSVFVSzBhYWlpeEp0Wlp3SFhfeE1UZllNT2tqUEtpWE1oVjNHLUUyZWkwXzlLcVRvamZpbHRISGVIVzBPWTRpTHZUNWQ5eUlpRnlzUnRtZU1zQ2lySHlqeXk5R1lvUWhJVWtxd294UDBSZWVwU3lMdzZJTm1pYVFzSm9mejVGcDY5dVRBeVJzUUZNMHF6MjBLS3k2S0FFbldmelFib1RxTklfanpUYUVzOWNHSHB1Z0NpSUpDYzk1S2J2T2tVWFhUV2k1dUxZTnpoSERBTjNrUkJhTTJaN1AzT3lodnNWRTI4T2F6M0xNY0RTWnBQYlpMUkJpbEl6Nm1Ja3ZXd0ZoSGxuSDM0dFpsN25sUTRGbno3LS1hRkhvblc5WVlTSTB3NWlHaFNuYUl3bDdSQTR1dnRnY2g5b09YME9nOGE5WmZ3ME5oOHo1VExadTRWa09OMGJHRkI4VnFuM1hGTnItOW9wOTZrQVhXZU43ek9nN3cxVlJNWk9GOExiRGp0akxTQ0N4dG9mcXhuSHdGZ3Y1QUVsNXdnWlM5a0poX05sUGQ3Z3NvZFdHT3o3cW80YkR3SVZSc0c1Mnd1OTA0VFE5VmdaU1ROQmxzOFNVNjliMjBkbzZqZjNlZGNPbUJ4akdTNFBMODdfdGU3aFQ1NTJmaFh0UnFoRVdhZ193YnBWWWwwcENNS2pDMVRlZVZWZk93WDJSYWRoc0Y1OXJFMEttZHV6RlROcGpoVWlTbFo4amZPY2NPYW16dGRlbVZFQ2hoU3pPS19HOTdybnRSWXN3aHk1bVBpZmp0SlFzWEt5cV9aWGQ2YkM1VTl2bFN0OENzTTN2NFZLSzlSMkhacG50Nmk4SDllVm1hVzVUZFlWWnlBcGhuLUZISkxsOW9HeHlZY2RicWJoWDV6VkNwLUlQTE9yZl9MY2E1ODJ1a2g0UGNSRXJERlo4WFA5Z05TSnk2Q1VvazNOS0I5MEpLazBzQ0htcW84WjRvUlBKSWxaQ0ozOXNxOWtYNlhnRlhSQ1hwWkNFTGF3UnFkS3RIRDBNMHd1akNCSkpvYjJqWVJoLWFqZExPUUtlWUVwcmUwU3Y4cy1UODg5NjZXd2UwZy1KQWkxX3dMUGVhaWY4ZmhtMl93a09qTlgtN2xRUnBjcTRCNXE5dFJ1RmQzakdoZzREUEVLQVB1dmUzU3dHbk9DU09hOEtzMXQzWDRqX25kbWpuWUlRZ2tha2ZFYktmX2dtY0xySEotTEpPREtpYWlhRV9KWDBrenNiSGp4bTI2ZjNjcTFYWDlYWTE1dVlFbUdtQVE4VHBlNnNoSV9qOHQycWtWLUloRFV0bWNPNkJISU5oY0FpREFYNHhqa3NLWFZBNmljQ2RPQy1LdUgxNGJvSk9TRjl3TUxwSGdYbXJPeWZnNnhjLV9fTlNxeTFQS25PRUlBRUZiWFctTFBSMTJMbEg1VzNPNFRTUjVRdy0zMDc4NDl6Z0xRdW5BX0R6MURmZmdlU0VwcWFMaHEzSDgzUGZkSFAxejlWZC1RWEdmS2hHNk1ETTJOYTA1bGVIUzYzMUNSei1kN0N0cEdaOWZKT0locC0wcy15NExlWHNha0kybFk5dzFtbFlPY0g1SWFPWmZiY1ZpZ1dXdVpBYmlsT3VKZWhwYk1DWFlzZ1AxZEVYTFpl)

        XCODE_WORKSPACE: "Runner.xcworkspace"
        XCODE_SCHEME: "Runner"
        BUNDLE_ID: "com.spotolcom.melCalc" # <-- Put your bundle id here
        APP_STORE_ID: MW924APR4Z # <-- Use the TestFlight Apple id number (An automatically generated ID assigned to your app) found under General > App Information > Apple ID.
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - name: Set up keychain to be used for codesigning using Codemagic CLI 'keychain' command
        script: |
          keychain initialize
      - name: Fetch signing files
        script: |
          app-store-connect fetch-signing-files $BUNDLE_ID --type IOS_APP_STORE --create
      - name: Use system default keychain
        script: |
          keychain add-certificates
      - name: Set up code signing settings on Xcode project
        script: |
          xcode-project use-profiles
      - name: Get Flutter packages
        script: |
          cd . && flutter packages pub get
      #      - name: Flutter analyze
      #        script: |
      #          cd . && flutter analyze
      #      - name: Flutter unit tests
      #        script: |
      #          cd . && flutter test
      #        ignore_failure: true
      - name: Install pods
        script: |
          find . -name "Podfile" -execdir pod install \;
      - name: Flutter build ipa and automatic versioning
        script: |
          flutter build ipa --release \
          --build-name=1.0.0 \
          --build-number=$(($(app-store-connect get-latest-testflight-build-number "$APP_STORE_ID") + 1)) \
          --export-options-plist=/Users/builder/export_options.plist
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - flutter_drive.log
    publishing:
      # See the following link for details about email publishing - https://docs.codemagic.io/publishing-yaml/distribution/#email
      email:
        recipients:
          - user_1@example.com
          - user_2@example.com
        notify:
          success: true     # To receive a notification when a build succeeds
          failure: false    # To not receive a notification when a build fails
      slack:
        # See the following link about how to connect your Slack account - https://docs.codemagic.io/publishing-yaml/distribution/#slack
        channel: "#builds"
        notify_on_build_start: true   # To receive a notification when a build starts
        notify:
          success: true               # To receive a notification when a build succeeds
          failure: false              # To not receive a notification when a build fails
      app_store_connect:   # https://docs.codemagic.io/publishing-yaml/distribution
        api_key: $APP_STORE_CONNECT_PRIVATE_KEY         # Contents of the API key, can also reference environment variable such as $APP_STORE_CONNECT_PRIVATE_KEY
        key_id: $APP_STORE_CONNECT_KEY_IDENTIFIER       # Alphanumeric value that identifies the API key, can also reference environment variable such as $APP_STORE_CONNECT_KEY_IDENTIFIER
        issuer_id: $APP_STORE_CONNECT_ISSUER_ID         # Alphanumeric value that identifies who created the API key, can also reference environment variable such as $APP_STORE_CONNECT_ISSUER_ID
        submit_to_testflight: false                     # Optional boolean, defaults to false. Whether or not to submit the uploaded build to TestFlight beta review. Required for distributing to beta groups. Note: This action is performed during post-processing.
        # beta_groups:                                  # Specify the names of beta tester groups that will get access to the build once it has passed beta review.
        #      - group name 1
        #      - group name 2


